<root>
    <LISTAR_TIPO_DOCUMENTO>
        <sql>
            SELECT
            TIP_ID AS ID,
            UPPER(TIP_DESCRIPCION) AS DESCRIPCION
            FROM
            TIPO_DOCUMENTO;
        </sql>
    </LISTAR_TIPO_DOCUMENTO>
    <LISTAR_TIPO_SEXO>
        <sql>
            SELECT
            SEX_ID AS ID,
            UPPER(SEX_DESCRIPCION) AS DESCRIPCION	
            FROM
            SEXO;
        </sql>
    </LISTAR_TIPO_SEXO>
    <LISTAR_DEPARTAMENTOS>
        <sql>
            SELECT
            DEP_ID AS ID,
            UPPER(DEP_DESCRIPCION) AS DESCRIPCION	
            FROM
            DEPARTAMENTO;
        </sql>
    </LISTAR_DEPARTAMENTOS>
    <LISTAR_CIUDADES>
        <sql>
            SELECT
            CIU_ID AS ID,
            UPPER(CIU_DESCRIPCION) AS DESCRIPCION	
            FROM
            CIUDAD 
            WHERE DEP_ID = ?;
        </sql>
    </LISTAR_CIUDADES>
    <LISTAR_BARRIOS>
        <sql>
            SELECT
            BARRIO_ID AS ID,
            UPPER(BARRIO_DESCRIPCION) AS DESCRIPCION 
            FROM
            BARRIOS 
            WHERE
            CIUD_ID =?
        </sql>
    </LISTAR_BARRIOS>
    <LISTAR_ESTADO_CIVIL>
        <sql>
            SELECT
            ETC_ID AS ID,
            UPPER(ETC_DESCRIPCION) AS DESCRIPCION	
            FROM
            ESTADO_CIVIL;
        </sql>
    </LISTAR_ESTADO_CIVIL>
    <LISTAR_MINISTERIOS>
        <sql>
            SELECT
            MIN_ID AS ID,
            UPPER(MIN_DESCRIPCION) AS DESCRIPCION	
            FROM
            MINISTERIOS;
        </sql>
    </LISTAR_MINISTERIOS>
    <CONSULTAR_CODIGO_PASTOR>
        <sql>
            SELECT
            PASTORES_COD AS PAST_COD 
            FROM
            PASTORES
            WHERE PASTORES_COD = ?
        </sql>
    </CONSULTAR_CODIGO_PASTOR>
    <AGREGAR_PASTOR_GENERAL>
        <sql>
            INSERT INTO TERCEROS (TIP_ID,TER_DOCUMENTO,TER_PRIMER_NOMBRE,TER_SEGUNDO_NOMBRE,TER_PRIMER_APELLIDO,TER_SEGUNDO_APELLIDO,DEP_ID,CIU_ID,TER_BARRIO,TER_DIRECCION,TER_TELEFONO,TER_CELULAR,SEX_ID,TER_EDAD,ETC_ID)VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?);
        </sql>
    </AGREGAR_PASTOR_GENERAL>
    <AGREGAR_PASTORGENERAL_DETALLE>
        <sql>
            INSERT INTO PASTORES ( TER_ID, MIN_ID, PASTORES_COD )
            VALUES
            (?,?,?);
        </sql>
    </AGREGAR_PASTORGENERAL_DETALLE>
    <VISUALIZAR_PASTORES_GENERAL>
        <sql>
            SELECT
            TER.TIP_ID AS TIPO_DOCUMENTO,
            TER.TER_DOCUMENTO AS DOCUMENTO,
            TER.TER_PRIMER_NOMBRE AS PRIMER_NOMBRE,
            TER.TER_SEGUNDO_NOMBRE AS SEGUNDO_NOMBRE,
            TER.TER_PRIMER_APELLIDO AS PRIMER_APELLIDO,
            TER.TER_SEGUNDO_APELLIDO AS SEGUNDO_APELLIDO,
            TER.DEP_ID AS DEPARTAMENTO,
            TER.CIU_ID AS CIUDAD,
            TER.TER_BARRIO AS BARRIO,
            TER.TER_DIRECCION AS DIRECCION,
            TER.TER_TELEFONO AS TELEFONO,
            TER.TER_CELULAR AS CELULAR,
            TER.SEX_ID AS SEXO,
            TER.TER_EDAD AS EDAD,
            TER.ETC_ID AS EST_CIVIL,
            PAST.MIN_ID AS MINISTERIO_ID,
            PAST.PASTORES_COD AS CODIGO,
            CONCAT( TER.TER_PRIMER_NOMBRE, ' ', TER.TER_SEGUNDO_NOMBRE, ' ', TER.TER_PRIMER_APELLIDO, ' ', TER.TER_SEGUNDO_APELLIDO ) AS NOMBRE,
            UPPER( MINT.MIN_DESCRIPCION ) AS MINISTERIO,
            PAST.PAST_ESTADO AS ESTADO_ID,
            CASE
            WHEN PAST.PAST_ESTADO = 'A' THEN
            'ACTIVO' 
            WHEN PAST.PAST_ESTADO = 'I' THEN
            'INACTIVO' 
            END AS ESTADO,
            TER.TER_ID AS TER_ID,
            PAST.PATORES_ID AS PASTGEN_ID 
            FROM
            PASTORES PAST
            INNER JOIN TERCEROS TER ON TER.TER_ID = PAST.TER_ID
            INNER JOIN MINISTERIOS MINT ON MINT.MIN_ID = PAST.MIN_ID
        </sql>
    </VISUALIZAR_PASTORES_GENERAL>
    <ACTUALIZAR_PASTOR_GENERAL>
        <sql>
            UPDATE TERCEROS SET
            TIP_ID = ?,
            TER_DOCUMENTO = ?,
            TER_PRIMER_NOMBRE = ?,
            TER_SEGUNDO_NOMBRE = ?,
            TER_PRIMER_APELLIDO = ?,
            TER_SEGUNDO_APELLIDO = ?,
            DEP_ID = ?,
            CIU_ID = ?,
            TER_BARRIO = ?,
            TER_DIRECCION = ?,
            TER_TELEFONO = ?,
            TER_CELULAR = ?,
            SEX_ID = ?,
            TER_EDAD = ?,
            ETC_ID = ?
            WHERE TER_ID = ?
        </sql>
    </ACTUALIZAR_PASTOR_GENERAL>
    <ACTUALIZAR_PASTORGENERAL_DETALLE>
        <sql>
            UPDATE pastores SET
            min_id = ?,
            pastores_cod = ?,
            past_estado = ?
            WHERE ter_id = ?
        </sql>
    </ACTUALIZAR_PASTORGENERAL_DETALLE>
    <LISTAR_PASTORES_GENERALES>
        <sql>
            SELECT
            PG.PATORES_ID AS ID,
            CONCAT(TER.TER_PRIMER_NOMBRE,' ',TER.TER_SEGUNDO_NOMBRE,' ', TER.TER_PRIMER_APELLIDO,' ',TER.TER_SEGUNDO_APELLIDO) AS DESCRIPCION
            FROM
            PASTORES PG
            INNER JOIN TERCEROS TER ON TER.TER_ID = PG.TER_ID
            WHERE PG.PAST_ESTADO = 'A'
        </sql>
    </LISTAR_PASTORES_GENERALES>
    <CONSULTAR_CODIGO_PASTOR_PRINCIPAL>
        <sql>
            SELECT
            COD_PASTORP 
            FROM
            PASTORES_PRINCIPALES 
            WHERE
            COD_PASTORP = ?
        </sql>
    </CONSULTAR_CODIGO_PASTOR_PRINCIPAL>
    <AGREGAR_PASTOR_PRINCIPAL>
        <sql>
            INSERT INTO TERCEROS (
            TIP_ID,
            TER_DOCUMENTO,
            TER_PRIMER_NOMBRE,
            TER_SEGUNDO_NOMBRE,
            TER_PRIMER_APELLIDO,
            TER_SEGUNDO_APELLIDO,
            DEP_ID,
            CIU_ID,
            TER_BARRIO,
            TER_DIRECCION,
            TER_TELEFONO,
            TER_CELULAR,
            SEX_ID,
            TER_EDAD,
            ETC_ID 
            )
            VALUES
            (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?);
        </sql>
    </AGREGAR_PASTOR_PRINCIPAL>
    <AGREGAR_PASTORPRINCIPAL_DETALLE>
        <sql>
            INSERT INTO PASTORES_PRINCIPALES(TER_ID,MIN_ID,COD_PASTORP, PASTOR_ID,PASTORP_ESTADO)VALUES(?,?,?,?,?);
        </sql>
    </AGREGAR_PASTORPRINCIPAL_DETALLE>
    <VISUALIZAR_PASTORES_PRINCIPAL>
        <sql>
            SELECT
            PP.PASTORP_ID AS ID_PP,
            TER.TER_ID AS TER_PP,
            PP.PASTOR_ID AS ID_PG,
            TER.TIP_ID AS TIPO_DOC,
            TER.TER_DOCUMENTO AS DOCUMENTO,
            TER.TER_PRIMER_NOMBRE AS PRIMER_NOMBRE,
            TER.TER_SEGUNDO_NOMBRE AS SEGUNDO_NOMBRE,
            TER.TER_PRIMER_APELLIDO AS PRIMER_APELLIDO,
            TER.TER_SEGUNDO_APELLIDO AS SEGUNDO_APELLIDO,
            CONCAT(TER.TER_PRIMER_NOMBRE,' ',TER.TER_SEGUNDO_NOMBRE,' ',TER.TER_PRIMER_APELLIDO,' ',TER.TER_SEGUNDO_APELLIDO) AS NOMBRE,
            TER.DEP_ID AS DEPT,
            TER.CIU_ID AS CIU,
            TER.TER_BARRIO AS BARRIO,
            TER.TER_DIRECCION AS DIRECCION,
            TER.TER_TELEFONO AS TELEFONO,
            TER.TER_CELULAR AS CELULAR,
            TER.SEX_ID AS SEXO,
            TER.TER_EDAD AS EDAD,
            TER.ETC_ID AS CIVIL,
            PP.MIN_ID AS ID_MINISTERIO,
            PP.COD_PASTORP AS COD_PP,
            CONCAT(TERPG.TER_PRIMER_NOMBRE,' ',TERPG.TER_SEGUNDO_NOMBRE,' ',TERPG.TER_PRIMER_APELLIDO,' ',TERPG.TER_SEGUNDO_APELLIDO) AS PASTORGENERAL,
            UPPER(MIN.MIN_DESCRIPCION) AS MINISTERIO,
            PP.PASTORP_ESTADO AS ID_ESTADO,
	        CASE 
			WHEN PP.PASTORP_ESTADO = "A" THEN "ACTIVO"
			ELSE "INACTIVO"
	        END AS ESTADO
            FROM
            TERCEROS TER
            INNER JOIN PASTORES_PRINCIPALES PP ON PP.TER_ID = TER.TER_ID
            INNER JOIN PASTORES P ON P.PATORES_ID = PP.PASTOR_ID
            INNER JOIN TERCEROS TERPG ON TERPG.TER_ID = P.TER_ID
            INNER JOIN MINISTERIOS MIN ON MIN.MIN_ID = PP.MIN_ID
        </sql>
    </VISUALIZAR_PASTORES_PRINCIPAL>
    <ACTUALIZAR_PASTOR_PRINCIPAL>
        <sql>
            UPDATE TERCEROS SET
            TIP_ID = ?,
            TER_DOCUMENTO = ?,
            TER_PRIMER_NOMBRE = ?,
            TER_SEGUNDO_NOMBRE = ?,
            TER_PRIMER_APELLIDO = ?,
            TER_SEGUNDO_APELLIDO = ?,
            DEP_ID = ?,
            CIU_ID = ?,
            TER_BARRIO = ?,
            TER_DIRECCION = ?,
            TER_TELEFONO = ?,
            TER_CELULAR = ?,
            SEX_ID = ?,
            TER_EDAD = ?,
            ETC_ID = ?
            WHERE TER_ID = ?
        </sql>
    </ACTUALIZAR_PASTOR_PRINCIPAL>
    <ACTUALIZAR_PASTORPRINCIPAL_DETALLE>
        <sql>
            UPDATE PASTORES_PRINCIPALES SET
            MIN_ID = ?,
            COD_PASTORP = ?,
            PASTORP_ESTADO = ?,
            PASTOR_ID = ?
            WHERE TER_ID = ? AND PASTORP_ID = ?
        </sql>
    </ACTUALIZAR_PASTORPRINCIPAL_DETALLE>
    <LISTAR_PASTORES_PRINCIPALES>
        <sql>
            SELECT
            PP.PASTORP_ID AS ID,
            CONCAT(TER.TER_PRIMER_NOMBRE,' ',TER.TER_SEGUNDO_NOMBRE, ' ',TER.TER_PRIMER_APELLIDO, TER.TER_SEGUNDO_APELLIDO) AS DESCRIPCION	
            FROM
            PASTORES_PRINCIPALES PP
            INNER JOIN TERCEROS TER ON TER.TER_ID = PP.TER_ID
        </sql>
    </LISTAR_PASTORES_PRINCIPALES>
    <CONSULTAR_DOCUMENTO>
        <sql>
            SELECT
            ter.ter_documento 
            FROM
            terceros ter
            WHERE ter.ter_documento = ?
        </sql>
    </CONSULTAR_DOCUMENTO>
    <AGREGAR_OBRERO>
        <sql>
            INSERT INTO TERCEROS (
            TIP_ID,
            TER_DOCUMENTO,
            TER_PRIMER_NOMBRE,
            TER_SEGUNDO_NOMBRE,
            TER_PRIMER_APELLIDO,
            TER_SEGUNDO_APELLIDO,
            DEP_ID,
            CIU_ID,
            TER_BARRIO,
            TER_DIRECCION,
            TER_TELEFONO,
            TER_CELULAR,
            SEX_ID,
            TER_EDAD,
            ETC_ID 
            )
            VALUES
            (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?);
        </sql>
    </AGREGAR_OBRERO>
    <AGREGAR_OBERRO_DETALLE>
        <sql>
            INSERT INTO OBRERO (TER_ID,PASTORP_ID,OBR_ESTADO)VALUES(?,?,?);
        </sql>
    </AGREGAR_OBERRO_DETALLE>
    <VISUALIZAR_OBREROS>
        <sql>
            SELECT
            OB.PASTORP_ID AS PP_ID,
            OB.OBR_ID AS OB_ID,
            OB.TER_ID AS OB_TERID,
            TER.TIP_ID AS TIPO_DOC,
            TER.TER_DOCUMENTO AS NUM_DOCUMENTO,
            TER.TER_PRIMER_NOMBRE AS PRIMER_NOMBRE,
            TER.TER_SEGUNDO_NOMBRE AS SEGUNDO_NOMBRE,
            TER.TER_PRIMER_APELLIDO AS PRIMER_APELLIDO,
            TER.TER_SEGUNDO_APELLIDO AS SEGUNDO_APELLIDO,
            CONCAT(TER.TER_PRIMER_NOMBRE,' ',TER.TER_SEGUNDO_NOMBRE,' ',TER.TER_PRIMER_APELLIDO,' ',TER.TER_SEGUNDO_APELLIDO) AS NOMBRE_COMPLETO,
            CONCAT(TERP.TER_PRIMER_NOMBRE,' ',TERP.TER_SEGUNDO_NOMBRE,' ',TERP.TER_PRIMER_APELLIDO,' ',TERP.TER_SEGUNDO_APELLIDO) AS NOMBRE_PASTOR,
            TER.DEP_ID AS DEPT_ID,
            TER.CIU_ID AS CIU_ID,
            TER.TER_BARRIO AS BARRIO_ID,
            TER.TER_DIRECCION AS DIRECCION,
            TER.TER_TELEFONO AS TELEFONO,
            TER.TER_CELULAR AS CELULAR,
            TER.SEX_ID AS SEXO_ID,
            TER.TER_EDAD AS EDAD,
            TER.ETC_ID AS ETC_ID,
            OB.OBR_ESTADO AS ESTADO_ID,
            CASE
            WHEN OB.OBR_ESTADO = 'A' THEN 'ACTIVO'
            ELSE 'INACTIVO'
            END AS ESTADO,
            UPPER(MIN.MIN_DESCRIPCION) AS MINISTERIO	
            FROM
            OBRERO OB
            INNER JOIN TERCEROS TER ON TER.TER_ID = OB.TER_ID
            INNER JOIN PASTORES_PRINCIPALES PP ON PP.PASTORP_ID = OB.PASTORP_ID
            INNER JOIN TERCEROS TERP ON TERP.TER_ID = PP.TER_ID
            INNER JOIN MINISTERIOS MIN ON MIN.MIN_ID = PP.MIN_ID
        </sql>
    </VISUALIZAR_OBREROS>
    <ACTUALIZAR_TEROBRERO>
        <sql>
            UPDATE TERCEROS SET
            TIP_ID = ?,
            TER_DOCUMENTO = ?,
            TER_PRIMER_NOMBRE = ?,
            TER_SEGUNDO_NOMBRE = ?,
            TER_PRIMER_APELLIDO = ?,
            TER_SEGUNDO_APELLIDO = ?,
            DEP_ID = ?,
            CIU_ID = ?,
            TER_BARRIO = ?,
            TER_DIRECCION = ?,
            TER_TELEFONO = ?,
            TER_CELULAR = ?,
            SEX_ID = ?,
            TER_EDAD = ?,
            ETC_ID = ?
            WHERE TER_ID = ?
        </sql>
    </ACTUALIZAR_TEROBRERO>
    <ACTUALIZAR_OBRERO_DETALLE>
        <sql>
            UPDATE OBRERO SET
            PASTORP_ID = ?,
            OBR_ESTADO = ?
            WHERE TER_ID = ? AND OBR_ID = ?
        </sql>
    </ACTUALIZAR_OBRERO_DETALLE>
</root>